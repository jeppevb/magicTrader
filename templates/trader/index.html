<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
		<meta />
		<title>Magic Trade</title>
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
		<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
		<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
		<link href="{{STATIC_URL}}toastr/toastr.css" rel="stylesheet"/>
		<script src="{{STATIC_URL}}toastr/toastr.js"></script>
		<script type="application/javascript">
			$(function() {
				$("#newBinderCardNameInput").autocomplete({
					source : function(request, response) {
						$.ajax({
							url : 'http://magictrader.kyomu.dk/cards/' + request.term,
							dataType : 'json'
						}).success(function(data) {
							response(data);
						});
					},
					response : function(event, ui) {
						if (ui.content.length < 1) {
							//if nothing came back do this
						}
					},
					select: function( event, ui ) {
						//populate fields
					}
				});
				$("#addBinderCardButton").click(
					function() {
						var mycardname = $("#newBinderCardNameInput").val();
						$.ajax({
							url : 'http://magictrader.kyomu.dk/gathercard/' + $("#newBinderCardNameInput").val(),
							dataType : 'json',
							statusCode : {
								404 : function() {toastr.error("Unable to find/add " + mycardname);} 
							}
						}).success(function(data){
							toastr.success("Added " + data + " to database");
							$("#newBinderCardNameInput" ).autocomplete("search");
						});
					}
				);
			});
			
		</script>
	</head>
	<body>
		<div>
			<h2>Trade Binder:</h2>
			<table>
				<tr>
					<td id="newBinderCardImage" class="imagecell"/><td id="newBinderCardName" class="ui-widget">
					<input id="newBinderCardNameInput" />
					<a href="#" id="addBinderCardButton">Find this card on gather so i can trade it</a></td>
					<td id="newBinderCardAmount" /><td id="newBinderCardFoil" /><td><a onclick="addBinderCard()" href="#">Add card to trade binder</a></td>
				</tr>
			</table>
		</div>
		<hr />
		<div>
			<h2>Communities:</h2>
			<ul>
				<li></li>
			</ul>
			<a href="#">Join community</a>
		</div>
		<script type="application/javascript">
			//$("#addBinderCardButton").hide(0);
		</script>
	</body>
</html>